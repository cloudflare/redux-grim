{"version":3,"file":"redux-grim.js","sources":["../src/redux/addHooks.js","../src/util.js","../src/redux/makeActionCreator.js","../node_modules/seamless-immutable/seamless-immutable.development.js","../src/redux/makeReducer.js","../src/redux/actions.js","../src/normalization/constants.js","../src/normalization/resolveRule.js","../src/normalization/denormalize.js","../src/normalization/processRules.js","../src/normalization/createSelector.js","../src/normalization/normalizationReducer.js","../src/normalization/normalize.js","../src/normalization/getNormalizerMiddleware.js"],"sourcesContent":["// The actions and reducers created by makeAction and makeReducer share a common\n// method for modifying actions are reducer states: 'on'.\n// E.g. on('start, () => ...).\n//\n// 'on' callbacks are executed in the order they are added, and the first\n// parameter is the object to be modified (an action for makeAction, and the\n// new state for makeReducer). Each callback must return the object, or its\n// modified version, as callbacks are chained, the return value becoming the\n// first parameter of the next call.\n//\n\n/**\n * @param target {Object} - object to which the 'on' function will be added.\n * @param hooks {Object} - a object consisting of a set of initials functions.\n *  also defined which hooks are valid for 'on'.\n * @returns target - the original target, so allow easy chaining.\n */\nexport default function addHooks(target, hooks) {\n  target.on = (hook, fn) => {\n    if (!hook in hooks) throw `invalid hook ${hook}`;\n\n    const previousHook = hooks[hook];\n    if (previousHook) {\n      hooks[hook] = (first, ...rest) =>\n        fn(previousHook(first, ...rest), ...rest);\n    } else {\n      hooks[hook] = fn;\n    }\n    return target;\n  };\n}\n","const startExtension = '.start';\nconst successExtension = '.success';\nconst errorExtension = '.error';\n\nexport const getStartType = entityType => `${entityType}${startExtension}`;\nexport const getSuccessType = entityType => `${entityType}${successExtension}`;\nexport const getErrorType = entityType => `${entityType}${errorExtension}`;\n\nexport const isStartType = type => type.endsWith(startExtension);\nexport const isSuccessType = type => type.endsWith(successExtension);\nexport const isErrorType = type => type.endsWith(errorExtension);\n","import addHooks from './addHooks';\nimport { getStartType, getSuccessType, getErrorType } from '../util';\n\nconst bodyMethods = ['put', 'patch', 'post'];\n\n// Regex to match the contents of () brackets\nconst parensReg = /\\(([^)]+)\\)/g; //\n\n// Regex to match the contents of [] brackets\nconst squareParensReg = /\\[([^)]+)\\]/g;\n\n// Actions can be modified using the 'on' method.\n// E.g. action.on('start', () => ..)\n//\n// This is a list of the possible values callback function is called with, and\n// the parameters they will be passed.\n// Each function must return the action, modified or otherwise.\n//\n// action - the action that was created by makeAction.\n// _namedParams - an object mapping from parameter name in the url to the value\n// that was passed to the action.\n// _restArgs - array of the rest of the params that were passed to the action.\n// _options - options object that was passed to makeAction\nconst defaultHooks = {\n  start: (action, _namedParams, _restArgs, _options) => action,\n  success: (action, _namedParams, _restArgs, _options) => action,\n  error: (action, _namedParams, _restArgs, _options) => action,\n  // All applies to start, success, and error actions\n  all: (action, _namedParams, _restArgs, _options) => action\n};\n\n// Some default behaviours when creating actions, that can be overridden.\n// apiFetch allows the fetch behaviour to be modified. restArgs - the parameters\n//  that were passed to the action after those specified by the url, are also\n//  passed to this function.\nconst defaultFunctions = {\n  apiFetch: (method, url, body, ..._rest) =>\n    // eslint-disable-next-line compat/compat\n    fetch(url, {\n      method: method.toUpperCase(),\n      body: JSON.stringify(body)\n    })\n};\n\n/**\n * Return true if the api and action functions require an object parameter\n * @param {String} method\n * @param {String} templateUrl\n * @returns boolean\n */\nfunction hasBodyParam(method, templateUrl) {\n  return (\n    bodyMethods.includes(method) ||\n    (method === 'delete' && templateUrl.includes('['))\n  );\n}\n\n/**\n * Extract an array of the named parameters in the url.\n *\n * E.g '/zone/(zoneId)/pool/[id]' -> ['zoneId', 'body'];\n *\n * If\n * @param {String} method\n * @param {String} templateUrl\n * @returns {Array}\n */\nexport function getNamedParameters(method, templateUrl) {\n  const params = new Set();\n  let match;\n  while ((match = parensReg.exec(templateUrl))) {\n    // Urls can reference the same object multiple times.\n    // E.g. /(zone.id)/(zone.organization.id)\n    // This will only add one named parameter to the array ('zone')\n    const str = match[1];\n    const periodIndex = str.indexOf('.');\n    params.add(periodIndex === -1 ? str : str.substr(0, str.indexOf('.')));\n  }\n  if (hasBodyParam(method, templateUrl)) {\n    params.add('body');\n  }\n  return params.size ? [...params] : [];\n}\n\n/**\n * Return a function that evaluates the url, using a params object to populate\n * the variable parts of the url.\n *\n * NOTE: Babel can't compile things that are inside of eval() or new Function(),\n * makeActionCreator() was using back-ticks (string templates) inside of new Function()\n * which busts IE11. So please use good old '+ foo +' in cases like this!\n *\n * E.g. const evaluate = makeUrlEvaluator('/zone/(zoneId)/pool/[id]');\n *      evaluate({ zoneId: 123, body: { id: 456 }})\n *      -> '/zone/123/create/456';\n *\n * @param {String} templateUrl\n * @returns {Function}\n */\nexport function makeUrlEvaluator(templateUrl) {\n  let url = templateUrl\n    // E.g. /(foo) -> /${params.foo}\n    .replace(parensReg, \"'+params.$1+'\")\n    // Adding empty [] to a delete url creates an action which takes a body param\n    .replace('[]', '')\n    // E.g. /[foo] -> /${params.body.foo}\n    .replace(squareParensReg, \"'+params.body.$1+'\");\n  return new Function('params', \"return '\" + url + \"';\");\n}\n\n\n/**\n * Returns a function which evaluates the tempalte url, with the action\n * arguments and returns an object containing the evaluated url, an object\n * mapping the named parameters to their actual values, and the rest of the\n * arguments supplied to the action.\n *\n * @param templateUrl {String}\n * @param namedParams {Array}\n * @returns {function}\n */\nexport function makeGetApiData(templateUrl, namedParams) {\n  const urlEvaluator = makeUrlEvaluator(templateUrl);\n\n  return (...args) => {\n    const params = namedParams.reduce((o, param, ii) => {\n      o[param] = args[ii];\n      return o;\n    }, {});\n\n    return {\n      url: urlEvaluator(params),\n      params,\n      restArgs: args.slice(namedParams.length)\n    };\n  };\n}\n\n/**\n * Create an asynchronous actions to access http resources.\n *\n * @param entityType {String} - used to create action types and match actions\n *   and reducers\n * @param method {String} - http method (get, post, etc)\n * @param templateUrl {String} - defines the url to access and the parameters\n *   which the action will accept. See the readme for for information.\n * @param options {Object} - An object which will be passed to the various\n *  hook functions. By default, this can only be used to log action creation,\n *  or a mismatch between expected parameters of an action and what is actually\n *  passed, by setting options = { debug: true }\n *\n */\nexport default function makeActionCreator(\n  entityType,\n  method,\n  templateUrl,\n  options = {}\n) {\n  const namedParams = getNamedParameters(method, templateUrl);\n  options.debug &&\n    logActionCreation(entityType, method, templateUrl, namedParams);\n\n  let mock;\n  const hooks = { ...defaultHooks };\n  const functions = { ...defaultFunctions };\n  const getApiData = makeGetApiData(templateUrl, namedParams);\n\n  const action = (...args) => async dispatch => {\n    if (options.debug) {\n      validateActionParameters(\n        entityType,\n        method,\n        templateUrl,\n        args,\n        namedParams\n      );\n    }\n\n    const { url, params, restArgs } = getApiData(...args);\n    let startAction = {\n      type: getStartType(entityType),\n      meta: {\n        entityType,\n        method\n      }\n    };\n    startAction = hooks.start(startAction, params, restArgs, options);\n    startAction = hooks.all(startAction, params, restArgs, options);\n    dispatch(startAction);\n\n    try {\n      let mockValue, response;\n      if (mock !== undefined) {\n        mockValue = typeof mock === 'function' ? mock(...args) : mock;\n        response = mockValue === undefined ? undefined : { body: mockValue };\n        response && console.info(`Mocking ${method} ${templateUrl}`, mockValue);\n      }\n      response =\n        response ||\n        (await functions.apiFetch(method, url, params.body, ...restArgs));\n\n      let successAction = {\n        type: getSuccessType(entityType),\n        payload: response && response.body,\n        meta: {\n          entityType,\n          method\n        }\n      };\n\n      successAction = hooks.success(\n        successAction,\n        params,\n        restArgs,\n        options,\n        response\n      );\n\n      successAction = hooks.all(\n        successAction,\n        params,\n        restArgs,\n        options,\n        response\n      );\n\n      const result = successAction.payload;\n      dispatch(successAction);\n      return result;\n    } catch (error) {\n      let errorAction = {\n        type: getErrorType(entityType),\n        payload: error,\n        error: true,\n        meta: {\n          entityType,\n          method\n        }\n      };\n      errorAction = hooks.error(errorAction, params, restArgs, options, error);\n      errorAction = hooks.all(errorAction, params, restArgs, options, error);\n      dispatch(errorAction);\n      throw error;\n    }\n  };\n\n  // All these functions return the action so they can be chained.\n  addHooks(action, hooks);\n  action.apiFetch = fn => ((functions.apiFetch = fn), action);\n  action.mock = fn => ((mock = fn), action);\n  action.unmock = () => ((mock = undefined), action);\n  return action;\n}\n\n/**\n * Called automatically when options = { debug: true }, to log information\n * about action creation.\n */\nexport function logActionCreation(entityType, method, url, namedParams) {\n  console.log(\n    `Created action ${entityType}, ${url}, ${method}(${namedParams.join(', ')})`\n  );\n}\n\n/**\n * Called automatically when options = { debug: true } to warn when there's\n * mismatch between the expected parameters of an action and what's actually\n * created.\n */\nexport function validateActionParameters(\n  entityType,\n  method,\n  url,\n  args,\n  namedParams\n) {\n  const hasBody =\n    url.indexOf('[') > -1 || ['post', 'put', 'patch'].includes(method);\n\n  // All parameters should be strings or numbers, unless there's a body, in\n  // which case the last parameter is an object.\n  if (args.length < namedParams.length) {\n    console.warn(\n      `For api call ${entityType}, ${method}, ${url},\n         Expected parameters: ${namedParams.join(', ')}\n         Actual parameters: ${args.join(', ')}\n      `\n    );\n  }\n  namedParams.forEach((param, ii) => {\n    const type = typeof args[ii];\n    if (hasBody && ii === namedParams.length - 1) {\n      if (type !== 'object') {\n        console.warn(\n          `${entityType}, ${method}, ${url}: Expected parameter ${\n            param\n          } to be an object. Actual value: ${args[ii]} ${type}`\n        );\n      }\n    } else if (type !== 'string' && type !== 'number') {\n      console.warn(\n        `${entityType}, ${method}, ${url}: Expected parameter ${\n          param\n        } to be a string or number. Actual value: ${args[ii]}`\n      );\n    }\n  });\n}\n","(function() {\n  \"use strict\";\n\nfunction immutableInit(config) {\n\n  // https://github.com/facebook/react/blob/v15.0.1/src/isomorphic/classic/element/ReactElement.js#L21\n  var REACT_ELEMENT_TYPE = typeof Symbol === 'function' && Symbol.for && Symbol.for('react.element');\n  var REACT_ELEMENT_TYPE_FALLBACK = 0xeac7;\n\n  var globalConfig = {\n    use_static: false\n  };\n  if (isObject(config)) {\n      if (config.use_static !== undefined) {\n          globalConfig.use_static = Boolean(config.use_static);\n      }\n  }\n\n  function isObject(data) {\n    return (\n      typeof data === 'object' &&\n      !Array.isArray(data) &&\n      data !== null\n    );\n  }\n\n  function instantiateEmptyObject(obj) {\n      var prototype = Object.getPrototypeOf(obj);\n      if (!prototype) {\n          return {};\n      } else {\n          return Object.create(prototype);\n      }\n  }\n\n  function addPropertyTo(target, methodName, value) {\n    Object.defineProperty(target, methodName, {\n      enumerable: false,\n      configurable: false,\n      writable: false,\n      value: value\n    });\n  }\n\n  function banProperty(target, methodName) {\n    addPropertyTo(target, methodName, function() {\n      throw new ImmutableError(\"The \" + methodName +\n        \" method cannot be invoked on an Immutable data structure.\");\n    });\n  }\n\n  var immutabilityTag = \"__immutable_invariants_hold\";\n\n  function addImmutabilityTag(target) {\n    addPropertyTo(target, immutabilityTag, true);\n  }\n\n  function isImmutable(target) {\n    if (typeof target === \"object\") {\n      return target === null || Boolean(\n        Object.getOwnPropertyDescriptor(target, immutabilityTag)\n      );\n    } else {\n      // In JavaScript, only objects are even potentially mutable.\n      // strings, numbers, null, and undefined are all naturally immutable.\n      return true;\n    }\n  }\n\n  function isEqual(a, b) {\n    // Avoid false positives due to (NaN !== NaN) evaluating to true\n    return (a === b || (a !== a && b !== b));\n  }\n\n  function isMergableObject(target) {\n    return target !== null && typeof target === \"object\" && !(Array.isArray(target)) && !(target instanceof Date);\n  }\n\n  var mutatingObjectMethods = [\n    \"setPrototypeOf\"\n  ];\n\n  var nonMutatingObjectMethods = [\n    \"keys\"\n  ];\n\n  var mutatingArrayMethods = mutatingObjectMethods.concat([\n    \"push\", \"pop\", \"sort\", \"splice\", \"shift\", \"unshift\", \"reverse\"\n  ]);\n\n  var nonMutatingArrayMethods = nonMutatingObjectMethods.concat([\n    \"map\", \"filter\", \"slice\", \"concat\", \"reduce\", \"reduceRight\"\n  ]);\n\n  var mutatingDateMethods = mutatingObjectMethods.concat([\n    \"setDate\", \"setFullYear\", \"setHours\", \"setMilliseconds\", \"setMinutes\", \"setMonth\", \"setSeconds\",\n    \"setTime\", \"setUTCDate\", \"setUTCFullYear\", \"setUTCHours\", \"setUTCMilliseconds\", \"setUTCMinutes\",\n    \"setUTCMonth\", \"setUTCSeconds\", \"setYear\"\n  ]);\n\n  function ImmutableError(message) {\n    this.name = 'MyError';\n    this.message = message;\n    this.stack = (new Error()).stack;\n  }\n  ImmutableError.prototype = new Error();\n  ImmutableError.prototype.constructor = Error;\n\n  function makeImmutable(obj, bannedMethods) {\n    // Tag it so we can quickly tell it's immutable later.\n    addImmutabilityTag(obj);\n\n    if (\"development\" !== \"production\") {\n      // Make all mutating methods throw exceptions.\n      for (var index in bannedMethods) {\n        if (bannedMethods.hasOwnProperty(index)) {\n          banProperty(obj, bannedMethods[index]);\n        }\n      }\n\n      // Freeze it and return it.\n      Object.freeze(obj);\n    }\n\n    return obj;\n  }\n\n  function makeMethodReturnImmutable(obj, methodName) {\n    var currentMethod = obj[methodName];\n\n    addPropertyTo(obj, methodName, function() {\n      return Immutable(currentMethod.apply(obj, arguments));\n    });\n  }\n\n  function arraySet(idx, value, config) {\n    var deep          = config && config.deep;\n\n    if (idx in this) {\n      if (deep && this[idx] !== value && isMergableObject(value) && isMergableObject(this[idx])) {\n        value = Immutable.merge(this[idx], value, {deep: true, mode: 'replace'});\n      }\n      if (isEqual(this[idx], value)) {\n        return this;\n      }\n    }\n\n    var mutable = asMutableArray.call(this);\n    mutable[idx] = Immutable(value);\n    return makeImmutableArray(mutable);\n  }\n\n  var immutableEmptyArray = Immutable([]);\n\n  function arraySetIn(pth, value, config) {\n    var head = pth[0];\n\n    if (pth.length === 1) {\n      return arraySet.call(this, head, value, config);\n    } else {\n      var tail = pth.slice(1);\n      var thisHead = this[head];\n      var newValue;\n\n      if (typeof(thisHead) === \"object\" && thisHead !== null) {\n        // Might (validly) be object or array\n        newValue = Immutable.setIn(thisHead, tail, value);\n      } else {\n        var nextHead = tail[0];\n        // If the next path part is a number, then we are setting into an array, else an object.\n        if (nextHead !== '' && isFinite(nextHead)) {\n          newValue = arraySetIn.call(immutableEmptyArray, tail, value);\n        } else {\n          newValue = objectSetIn.call(immutableEmptyObject, tail, value);\n        }\n      }\n\n      if (head in this && thisHead === newValue) {\n        return this;\n      }\n\n      var mutable = asMutableArray.call(this);\n      mutable[head] = newValue;\n      return makeImmutableArray(mutable);\n    }\n  }\n\n  function makeImmutableArray(array) {\n    // Don't change their implementations, but wrap these functions to make sure\n    // they always return an immutable value.\n    for (var index in nonMutatingArrayMethods) {\n      if (nonMutatingArrayMethods.hasOwnProperty(index)) {\n        var methodName = nonMutatingArrayMethods[index];\n        makeMethodReturnImmutable(array, methodName);\n      }\n    }\n\n    if (!globalConfig.use_static) {\n      addPropertyTo(array, \"flatMap\",  flatMap);\n      addPropertyTo(array, \"asObject\", asObject);\n      addPropertyTo(array, \"asMutable\", asMutableArray);\n      addPropertyTo(array, \"set\", arraySet);\n      addPropertyTo(array, \"setIn\", arraySetIn);\n      addPropertyTo(array, \"update\", update);\n      addPropertyTo(array, \"updateIn\", updateIn);\n      addPropertyTo(array, \"getIn\", getIn);\n    }\n\n    for(var i = 0, length = array.length; i < length; i++) {\n      array[i] = Immutable(array[i]);\n    }\n\n    return makeImmutable(array, mutatingArrayMethods);\n  }\n\n  function makeImmutableDate(date) {\n    if (!globalConfig.use_static) {\n      addPropertyTo(date, \"asMutable\", asMutableDate);\n    }\n\n    return makeImmutable(date, mutatingDateMethods);\n  }\n\n  function asMutableDate() {\n    return new Date(this.getTime());\n  }\n\n  /**\n   * Effectively performs a map() over the elements in the array, using the\n   * provided iterator, except that whenever the iterator returns an array, that\n   * array's elements are added to the final result instead of the array itself.\n   *\n   * @param {function} iterator - The iterator function that will be invoked on each element in the array. It will receive three arguments: the current value, the current index, and the current object.\n   */\n  function flatMap(iterator) {\n    // Calling .flatMap() with no arguments is a no-op. Don't bother cloning.\n    if (arguments.length === 0) {\n      return this;\n    }\n\n    var result = [],\n        length = this.length,\n        index;\n\n    for (index = 0; index < length; index++) {\n      var iteratorResult = iterator(this[index], index, this);\n\n      if (Array.isArray(iteratorResult)) {\n        // Concatenate Array results into the return value we're building up.\n        result.push.apply(result, iteratorResult);\n      } else {\n        // Handle non-Array results the same way map() does.\n        result.push(iteratorResult);\n      }\n    }\n\n    return makeImmutableArray(result);\n  }\n\n  /**\n   * Returns an Immutable copy of the object without the given keys included.\n   *\n   * @param {array} keysToRemove - A list of strings representing the keys to exclude in the return value. Instead of providing a single array, this method can also be called by passing multiple strings as separate arguments.\n   */\n  function without(remove) {\n    // Calling .without() with no arguments is a no-op. Don't bother cloning.\n    if (typeof remove === \"undefined\" && arguments.length === 0) {\n      return this;\n    }\n\n    if (typeof remove !== \"function\") {\n      // If we weren't given an array, use the arguments list.\n      var keysToRemoveArray = (Array.isArray(remove)) ?\n         remove.slice() : Array.prototype.slice.call(arguments);\n\n      // Convert numeric keys to strings since that's how they'll\n      // come from the enumeration of the object.\n      keysToRemoveArray.forEach(function(el, idx, arr) {\n        if(typeof(el) === \"number\") {\n          arr[idx] = el.toString();\n        }\n      });\n\n      remove = function(val, key) {\n        return keysToRemoveArray.indexOf(key) !== -1;\n      };\n    }\n\n    var result = instantiateEmptyObject(this);\n\n    for (var key in this) {\n      if (this.hasOwnProperty(key) && remove(this[key], key) === false) {\n        result[key] = this[key];\n      }\n    }\n\n    return makeImmutableObject(result);\n  }\n\n  function asMutableArray(opts) {\n    var result = [], i, length;\n\n    if(opts && opts.deep) {\n      for(i = 0, length = this.length; i < length; i++) {\n        result.push(asDeepMutable(this[i]));\n      }\n    } else {\n      for(i = 0, length = this.length; i < length; i++) {\n        result.push(this[i]);\n      }\n    }\n\n    return result;\n  }\n\n  /**\n   * Effectively performs a [map](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/map) over the elements in the array, expecting that the iterator function\n   * will return an array of two elements - the first representing a key, the other\n   * a value. Then returns an Immutable Object constructed of those keys and values.\n   *\n   * @param {function} iterator - A function which should return an array of two elements - the first representing the desired key, the other the desired value.\n   */\n  function asObject(iterator) {\n    // If no iterator was provided, assume the identity function\n    // (suggesting this array is already a list of key/value pairs.)\n    if (typeof iterator !== \"function\") {\n      iterator = function(value) { return value; };\n    }\n\n    var result = {},\n        length = this.length,\n        index;\n\n    for (index = 0; index < length; index++) {\n      var pair  = iterator(this[index], index, this),\n          key   = pair[0],\n          value = pair[1];\n\n      result[key] = value;\n    }\n\n    return makeImmutableObject(result);\n  }\n\n  function asDeepMutable(obj) {\n    if (\n      (!obj) ||\n      (typeof obj !== 'object') ||\n      (!Object.getOwnPropertyDescriptor(obj, immutabilityTag)) ||\n      (obj instanceof Date)\n    ) { return obj; }\n    return Immutable.asMutable(obj, {deep: true});\n  }\n\n  function quickCopy(src, dest) {\n    for (var key in src) {\n      if (Object.getOwnPropertyDescriptor(src, key)) {\n        dest[key] = src[key];\n      }\n    }\n\n    return dest;\n  }\n\n  /**\n   * Returns an Immutable Object containing the properties and values of both\n   * this object and the provided object, prioritizing the provided object's\n   * values whenever the same key is present in both objects.\n   *\n   * @param {object} other - The other object to merge. Multiple objects can be passed as an array. In such a case, the later an object appears in that list, the higher its priority.\n   * @param {object} config - Optional config object that contains settings. Supported settings are: {deep: true} for deep merge and {merger: mergerFunc} where mergerFunc is a function\n   *                          that takes a property from both objects. If anything is returned it overrides the normal merge behaviour.\n   */\n  function merge(other, config) {\n    // Calling .merge() with no arguments is a no-op. Don't bother cloning.\n    if (arguments.length === 0) {\n      return this;\n    }\n\n    if (other === null || (typeof other !== \"object\")) {\n      throw new TypeError(\"Immutable#merge can only be invoked with objects or arrays, not \" + JSON.stringify(other));\n    }\n\n    var receivedArray = (Array.isArray(other)),\n        deep          = config && config.deep,\n        mode          = config && config.mode || 'merge',\n        merger        = config && config.merger,\n        result;\n\n    // Use the given key to extract a value from the given object, then place\n    // that value in the result object under the same key. If that resulted\n    // in a change from this object's value at that key, set anyChanges = true.\n    function addToResult(currentObj, otherObj, key) {\n      var immutableValue = Immutable(otherObj[key]);\n      var mergerResult = merger && merger(currentObj[key], immutableValue, config);\n      var currentValue = currentObj[key];\n\n      if ((result !== undefined) ||\n        (mergerResult !== undefined) ||\n        (!currentObj.hasOwnProperty(key)) ||\n        !isEqual(immutableValue, currentValue)) {\n\n        var newValue;\n\n        if (mergerResult) {\n          newValue = mergerResult;\n        } else if (deep && isMergableObject(currentValue) && isMergableObject(immutableValue)) {\n          newValue = Immutable.merge(currentValue, immutableValue, config);\n        } else {\n          newValue = immutableValue;\n        }\n\n        if (!isEqual(currentValue, newValue) || !currentObj.hasOwnProperty(key)) {\n          if (result === undefined) {\n            // Make a shallow clone of the current object.\n            result = quickCopy(currentObj, instantiateEmptyObject(currentObj));\n          }\n\n          result[key] = newValue;\n        }\n      }\n    }\n\n    function clearDroppedKeys(currentObj, otherObj) {\n      for (var key in currentObj) {\n        if (!otherObj.hasOwnProperty(key)) {\n          if (result === undefined) {\n            // Make a shallow clone of the current object.\n            result = quickCopy(currentObj, instantiateEmptyObject(currentObj));\n          }\n          delete result[key];\n        }\n      }\n    }\n\n    var key;\n\n    // Achieve prioritization by overriding previous values that get in the way.\n    if (!receivedArray) {\n      // The most common use case: just merge one object into the existing one.\n      for (key in other) {\n        if (Object.getOwnPropertyDescriptor(other, key)) {\n          addToResult(this, other, key);\n        }\n      }\n      if (mode === 'replace') {\n        clearDroppedKeys(this, other);\n      }\n    } else {\n      // We also accept an Array\n      for (var index = 0, length = other.length; index < length; index++) {\n        var otherFromArray = other[index];\n\n        for (key in otherFromArray) {\n          if (otherFromArray.hasOwnProperty(key)) {\n            addToResult(result !== undefined ? result : this, otherFromArray, key);\n          }\n        }\n      }\n    }\n\n    if (result === undefined) {\n      return this;\n    } else {\n      return makeImmutableObject(result);\n    }\n  }\n\n  function objectReplace(value, config) {\n    var deep          = config && config.deep;\n\n    // Calling .replace() with no arguments is a no-op. Don't bother cloning.\n    if (arguments.length === 0) {\n      return this;\n    }\n\n    if (value === null || typeof value !== \"object\") {\n      throw new TypeError(\"Immutable#replace can only be invoked with objects or arrays, not \" + JSON.stringify(value));\n    }\n\n    return Immutable.merge(this, value, {deep: deep, mode: 'replace'});\n  }\n\n  var immutableEmptyObject = Immutable({});\n\n  function objectSetIn(path, value, config) {\n    if (!(Array.isArray(path)) || path.length === 0) {\n      throw new TypeError(\"The first argument to Immutable#setIn must be an array containing at least one \\\"key\\\" string.\");\n    }\n\n    var head = path[0];\n    if (path.length === 1) {\n      return objectSet.call(this, head, value, config);\n    }\n\n    var tail = path.slice(1);\n    var newValue;\n    var thisHead = this[head];\n\n    if (this.hasOwnProperty(head) && typeof(thisHead) === \"object\" && thisHead !== null) {\n      // Might (validly) be object or array\n      newValue = Immutable.setIn(thisHead, tail, value);\n    } else {\n      newValue = objectSetIn.call(immutableEmptyObject, tail, value);\n    }\n\n    if (this.hasOwnProperty(head) && thisHead === newValue) {\n      return this;\n    }\n\n    var mutable = quickCopy(this, instantiateEmptyObject(this));\n    mutable[head] = newValue;\n    return makeImmutableObject(mutable);\n  }\n\n  function objectSet(property, value, config) {\n    var deep          = config && config.deep;\n\n    if (this.hasOwnProperty(property)) {\n      if (deep && this[property] !== value && isMergableObject(value) && isMergableObject(this[property])) {\n        value = Immutable.merge(this[property], value, {deep: true, mode: 'replace'});\n      }\n      if (isEqual(this[property], value)) {\n        return this;\n      }\n    }\n\n    var mutable = quickCopy(this, instantiateEmptyObject(this));\n    mutable[property] = Immutable(value);\n    return makeImmutableObject(mutable);\n  }\n\n  function update(property, updater) {\n    var restArgs = Array.prototype.slice.call(arguments, 2);\n    var initialVal = this[property];\n    return Immutable.set(this, property, updater.apply(initialVal, [initialVal].concat(restArgs)));\n  }\n\n  function getInPath(obj, path) {\n    /*jshint eqnull:true */\n    for (var i = 0, l = path.length; obj != null && i < l; i++) {\n      obj = obj[path[i]];\n    }\n\n    return (i && i == l) ? obj : undefined;\n  }\n\n  function updateIn(path, updater) {\n    var restArgs = Array.prototype.slice.call(arguments, 2);\n    var initialVal = getInPath(this, path);\n\n    return Immutable.setIn(this, path, updater.apply(initialVal, [initialVal].concat(restArgs)));\n  }\n\n  function getIn(path, defaultValue) {\n    var value = getInPath(this, path);\n    return value === undefined ? defaultValue : value;\n  }\n\n  function asMutableObject(opts) {\n    var result = instantiateEmptyObject(this), key;\n\n    if(opts && opts.deep) {\n      for (key in this) {\n        if (this.hasOwnProperty(key)) {\n          result[key] = asDeepMutable(this[key]);\n        }\n      }\n    } else {\n      for (key in this) {\n        if (this.hasOwnProperty(key)) {\n          result[key] = this[key];\n        }\n      }\n    }\n\n    return result;\n  }\n\n  // Creates plain object to be used for cloning\n  function instantiatePlainObject() {\n    return {};\n  }\n\n  // Finalizes an object with immutable methods, freezes it, and returns it.\n  function makeImmutableObject(obj) {\n    if (!globalConfig.use_static) {\n      addPropertyTo(obj, \"merge\", merge);\n      addPropertyTo(obj, \"replace\", objectReplace);\n      addPropertyTo(obj, \"without\", without);\n      addPropertyTo(obj, \"asMutable\", asMutableObject);\n      addPropertyTo(obj, \"set\", objectSet);\n      addPropertyTo(obj, \"setIn\", objectSetIn);\n      addPropertyTo(obj, \"update\", update);\n      addPropertyTo(obj, \"updateIn\", updateIn);\n      addPropertyTo(obj, \"getIn\", getIn);\n    }\n\n    return makeImmutable(obj, mutatingObjectMethods);\n  }\n\n  // Returns true if object is a valid react element\n  // https://github.com/facebook/react/blob/v15.0.1/src/isomorphic/classic/element/ReactElement.js#L326\n  function isReactElement(obj) {\n    return typeof obj === 'object' &&\n           obj !== null &&\n           (obj.$$typeof === REACT_ELEMENT_TYPE_FALLBACK || obj.$$typeof === REACT_ELEMENT_TYPE);\n  }\n\n  function isFileObject(obj) {\n    return typeof File !== 'undefined' &&\n           obj instanceof File;\n  }\n\n  function isBlobObject(obj) {\n    return typeof Blob !== 'undefined' &&\n           obj instanceof Blob;\n  }\n\n  function isPromise(obj) {\n    return typeof obj === 'object' &&\n           typeof obj.then === 'function';\n  }\n\n  function isError(obj) {\n    return obj instanceof Error;\n  }\n\n  function Immutable(obj, options, stackRemaining) {\n    if (isImmutable(obj) || isReactElement(obj) || isFileObject(obj) || isBlobObject(obj) || isError(obj)) {\n      return obj;\n    } else if (isPromise(obj)) {\n      return obj.then(Immutable);\n    } else if (Array.isArray(obj)) {\n      return makeImmutableArray(obj.slice());\n    } else if (obj instanceof Date) {\n      return makeImmutableDate(new Date(obj.getTime()));\n    } else {\n      // Don't freeze the object we were given; make a clone and use that.\n      var prototype = options && options.prototype;\n      var instantiateEmptyObject =\n        (!prototype || prototype === Object.prototype) ?\n          instantiatePlainObject : (function() { return Object.create(prototype); });\n      var clone = instantiateEmptyObject();\n\n      if (\"development\" !== \"production\") {\n        /*jshint eqnull:true */\n        if (stackRemaining == null) {\n          stackRemaining = 64;\n        }\n        if (stackRemaining <= 0) {\n          throw new ImmutableError(\"Attempt to construct Immutable from a deeply nested object was detected.\" +\n            \" Have you tried to wrap an object with circular references (e.g. React element)?\" +\n            \" See https://github.com/rtfeldman/seamless-immutable/wiki/Deeply-nested-object-was-detected for details.\");\n        }\n        stackRemaining -= 1;\n      }\n\n      for (var key in obj) {\n        if (Object.getOwnPropertyDescriptor(obj, key)) {\n          clone[key] = Immutable(obj[key], undefined, stackRemaining);\n        }\n      }\n\n      return makeImmutableObject(clone);\n    }\n  }\n\n  // Wrapper to allow the use of object methods as static methods of Immutable.\n  function toStatic(fn) {\n    function staticWrapper() {\n      var args = [].slice.call(arguments);\n      var self = args.shift();\n      return fn.apply(self, args);\n    }\n\n    return staticWrapper;\n  }\n\n  // Wrapper to allow the use of object methods as static methods of Immutable.\n  // with the additional condition of choosing which function to call depending\n  // if argument is an array or an object.\n  function toStaticObjectOrArray(fnObject, fnArray) {\n    function staticWrapper() {\n      var args = [].slice.call(arguments);\n      var self = args.shift();\n      if (Array.isArray(self)) {\n          return fnArray.apply(self, args);\n      } else {\n          return fnObject.apply(self, args);\n      }\n    }\n\n    return staticWrapper;\n  }\n\n  // Wrapper to allow the use of object methods as static methods of Immutable.\n  // with the additional condition of choosing which function to call depending\n  // if argument is an array or an object or a date.\n  function toStaticObjectOrDateOrArray(fnObject, fnArray, fnDate) {\n    function staticWrapper() {\n      var args = [].slice.call(arguments);\n      var self = args.shift();\n      if (Array.isArray(self)) {\n          return fnArray.apply(self, args);\n      } else if (self instanceof Date) {\n          return fnDate.apply(self, args);\n      } else {\n          return fnObject.apply(self, args);\n      }\n    }\n\n    return staticWrapper;\n  }\n\n  // Export the library\n  Immutable.from           = Immutable;\n  Immutable.isImmutable    = isImmutable;\n  Immutable.ImmutableError = ImmutableError;\n  Immutable.merge          = toStatic(merge);\n  Immutable.replace        = toStatic(objectReplace);\n  Immutable.without        = toStatic(without);\n  Immutable.asMutable      = toStaticObjectOrDateOrArray(asMutableObject, asMutableArray, asMutableDate);\n  Immutable.set            = toStaticObjectOrArray(objectSet, arraySet);\n  Immutable.setIn          = toStaticObjectOrArray(objectSetIn, arraySetIn);\n  Immutable.update         = toStatic(update);\n  Immutable.updateIn       = toStatic(updateIn);\n  Immutable.getIn          = toStatic(getIn);\n  Immutable.flatMap        = toStatic(flatMap);\n  Immutable.asObject       = toStatic(asObject);\n  if (!globalConfig.use_static) {\n      Immutable.static = immutableInit({\n          use_static: true\n      });\n  }\n\n  Object.freeze(Immutable);\n\n  return Immutable;\n}\n\n  var Immutable = immutableInit();\n  /* istanbul ignore if */\n  if (typeof define === 'function' && define.amd) {\n    define(function() {\n      return Immutable;\n    });\n  } else if (typeof module === \"object\") {\n    module.exports = Immutable;\n  } else if (typeof exports === \"object\") {\n    exports.Immutable = Immutable;\n  } else if (typeof window === \"object\") {\n    window.Immutable = Immutable;\n  } else if (typeof global === \"object\") {\n    global.Immutable = Immutable;\n  }\n})();\n","import { static as Immutable } from 'seamless-immutable';\nimport addHooks from './addHooks';\nimport { getStartType, getSuccessType, getErrorType } from '../util';\n\nexport const defaultState = Immutable.from({\n  data: undefined,\n  error: null,\n  isRequesting: false,\n  isErrored: false\n});\n\nconst defaultErrorKey = 'error';\n\nexport default function makeReducer(entityType, options) {\n  const hooks = {\n    start: (nextState, _prevState, _action, _options) => nextState,\n    success: (nextState, _state, _action, _options) => nextState,\n    error: (nextState, _state, _action, _options) => nextState,\n    all: (nextState, _state, _action, _options) => nextState,\n    default: (state, _action, _options) => state\n  };\n\n  const startType = getStartType(entityType);\n  const successType = getSuccessType(entityType);\n  const errorType = getErrorType(entityType);\n\n  let errorKey = (options && options.errorKey) || defaultErrorKey;\n\n  let initialState =\n    errorKey === defaultErrorKey\n      ? defaultState\n      : (initialState = Immutable.from({\n          ...Immutable.without(defaultState, 'error'),\n          [errorKey]: null\n        }));\n\n  const reducer = (state = initialState, action) => {\n    let nextState;\n    switch (action.type) {\n      case startType:\n        nextState = {\n          ...state,\n          isRequesting: true,\n          isErrored: false,\n          [errorKey]: null\n        };\n\n        nextState = hooks.start(nextState, state, action, options);\n        nextState = hooks.all(nextState, state, action, options);\n        return Immutable.from(nextState);\n\n      case successType:\n        nextState = {\n          ...state,\n          data: action.payload,\n          isRequesting: false,\n          isErrored: false\n        };\n\n        nextState = hooks.success(nextState, state, action, options);\n        nextState = hooks.all(nextState, state, action, options);\n        return Immutable.from(nextState);\n\n      case errorType:\n        nextState = {\n          ...state,\n          isRequesting: false,\n          isErrored: true,\n          [errorKey]: action.payload\n        };\n\n        nextState = hooks.error(nextState, state, action, options);\n        nextState = hooks.all(nextState, state, action, options);\n        return Immutable.from(nextState);\n\n      case `${entityType}.set`:\n        // Restrict the change to the data property\n        let path = ['data'];\n        if (action.meta.path) {\n          path = path.concat(action.meta.path);\n        }\n        return Immutable.setIn(state, path, action.payload);\n\n      case 'grim.reset':\n        const { includes, excludes } = action.payload;\n        if (includes) {\n          if (includes.includes(entityType)) {\n            return initialState;\n          }\n        } else if (!excludes || !excludes.includes(entityType)) {\n          return initialState;\n        }\n\n      default:\n        nextState = hooks.default\n          ? hooks.default(state, action, options)\n          : nextState;\n        return Immutable.from(nextState);\n    }\n  };\n\n  addHooks(reducer, hooks);\n  reducer.modifyInitialState = fn => (\n    (initialState = fn(initialState)), reducer\n  );\n\n  return reducer;\n}\n","export function setAction(entityType, payload, path) {\n  return {\n    type: `${entityType}.set`,\n    payload,\n    meta: {\n      entityType,\n      path\n    }\n  };\n}\n\nexport function resetAction({ includes, excludes } = {}) {\n  return {\n    type: 'grim.reset',\n    payload: {\n      excludes,\n      includes\n    }\n  };\n}\n","export const defaultId = 'id';\nexport const idProp = 'idProp';\nexport const targetProp = 'to';\nexport const propertiesProp = 'nestedProps';\n","import { targetProp, propertiesProp, idProp } from './constants';\n\n// If the rule has an alias, chain through all the rules to find the base rule.\nexport default function resolveRule(rules, type) {\n  let rule = rules[type];\n  let entityType = rule && type;\n\n  while (rule && rule[targetProp]) {\n    if (rule[idProp] || rule[propertiesProp]) {\n      throw `'${targetProp}' aliases cannot be used with '${idProp}' and '${propertiesProp}' properties`;\n    }\n    entityType = rule[targetProp];\n    rule = rules[rule[targetProp]];\n  }\n\n  return { entityType, rule };\n}\n","import resolveRule from './resolveRule';\nimport { propertiesProp } from './constants';\n/**\n * @param {Object} rules - object specifying how entities are\n *   normalized\n * @param {id | Array[id] | object} id - Item or items to be denormalised\n * @oaram {String} entityType - key indicating the type of the normalized id/ids\n * @param {Object} state - The part of the state tree mapping from\n *   entityType => id => to the  entity data\n *\n * @return Denormalized object, or the original id parameter unchanged.\n */\nexport default function denormalize(rules, entityType, id, state) {\n  if (!id) return id;\n\n  const { rule, entityType: type } = resolveRule(rules, entityType);\n\n  if (Array.isArray(id)) {\n    return id.map(id => denormalize(rules, type, id, state));\n  }\n\n  // Denormalize an object - treat it as a map and denormalize the values\n  if (typeof id === 'object') {\n    return Object.entries(id).reduce((obj, [prop, id]) => {\n      obj[prop] = denormalize(rules, type, id, state);\n      return obj;\n    }, {});\n  }\n\n  const stateEntity = state[type] && state[type][id];\n\n  // The entity data may not exist in the state (it may be fetched by a separate\n  // endpoint) in which case just return the id.\n  if (!stateEntity) return id;\n\n  const entity = { ...stateEntity };\n\n  // Denormalize any child properties specified by the rule\n  if (rule[propertiesProp]) {\n    for (const [prop, type] of Object.entries(rule[propertiesProp])) {\n      entity[prop] = denormalize(rules, type, entity[prop], state);\n    }\n  }\n\n  return entity;\n}\n","import { idProp, targetProp, propertiesProp } from './constants';\n\n// Very simple schema parsing, using typeof types.\n// propName: 'string' - propName must be defined and of type 'string'.\n// propName: 'number?' - propName may be undefined or have type number\n// propName: 'string{}' - propName must be defined, and is an object, every\n//   property of which must be a 'string'\n// propName: 'number{}?' - propName may be undefined or must be an object\n//   every property of which must be a 'number'\nconst configSchema = {\n  entityType: 'string',\n  [idProp]: 'string?',\n  [targetProp]: 'string?',\n  [propertiesProp]: 'string{}?'\n};\n\n// Used to split the schema descriptions.\n// E.g. 'abc{}?'.split(/(\\{\\})?(\\??)$/) -> [\"abc\", \"{}\", \"?\", \"\"];\nconst schemaRE = /(\\{\\})?(\\??)$/;\n\n// Verifies that every member of an array matches the specified schema, see\n// above.\nconst verifySchema = (arr, schema) =>\n  arr.every(obj => {\n    const keys = new Set([...Object.keys(configSchema), ...Object.keys(obj)]);\n    return Array.from(keys).every(propName => {\n      const schemaValue = schema[propName];\n      if (schemaValue === undefined) return;\n\n      const [schemaType, ...rest] = schemaValue.split(schemaRE);\n      const isOptional = rest.indexOf('?') > -1;\n      const isObject = rest.indexOf('{}') > -1;\n\n      const objValue = obj[propName];\n      const objType = typeof objValue;\n\n      if (isOptional && objValue === undefined) return true;\n\n      if (isObject) {\n        return (\n          objType === 'object' &&\n          Object.values(objValue).every(val => typeof val === schemaType)\n        );\n      }\n\n      return objValue !== undefined && typeof objType === schemaType;\n    });\n  });\n\nlet cachedRules;\nlet previousRules;\nlet previousLength;\n\nexport default function processRules(rules) {\n  if (\n    cachedRules &&\n    rules === previousRules &&\n    rules.length === previousLength\n  ) {\n    return cachedRules;\n  }\n\n  if (!verifySchema(rules, configSchema)) {\n    throw 'Error: rules do not match schema';\n  }\n\n  cachedRules = rules.reduce((o, rule) => ((o[rule.entityType] = rule), o), {});\n  previousRules = rules;\n  previousLength = rules.length;\n  return cachedRules;\n}\n","import { static as Immutable } from 'seamless-immutable';\nimport resolveRule from './resolveRule';\nimport denormalize from './denormalize';\nimport processRules from './processRules';\nimport { propertiesProp } from './constants';\n\n/**\n * Test if two arrays are the same, or contain the same contents\n */\nexport function arrayEquals(arr1, arr2) {\n  return (\n    arr1 === arr2 ||\n    (arr1 &&\n      arr2 &&\n      arr1.length === arr2.length &&\n      arr1.every((item, ii) => item === arr2[ii]))\n  );\n}\n\n/**\n * Build an array of all dependant entity types.\n * Note: This doesn't handle cyclic dependencies. Please don't introduce any.\n */\nexport function getEntityTypes(rules, type) {\n  const { rule, entityType } = resolveRule(rules, type);\n  let entityTypes = entityType && [entityType];\n  if (rule && rule[propertiesProp]) {\n    for (const key of Object.values(rule[propertiesProp])) {\n      entityTypes = [...entityTypes, ...getEntityTypes(rules, key)];\n    }\n  }\n  return entityTypes;\n}\n\n/**\n * Creates a memoized selector which returns denormalized objects.\n *\n * @param rules {object} optional - Describes how objects are normalized\n * @param entitiesSelector {function} - selector function which takes the state\n *   and returns the part of the state tree where normalized entity data lives.\n * @param entityType {string} - the type of the entity being selected\n * @param selector {function} - selector function. See below.\n * @returns a memoized selector function which returns denormalized entities.\n *\n * The selector parameter is a function which takes the state and resolves to\n * one of three types:\n * 1. an id.\n *    The entity selector returns the object corresponding to the id\n * 2. an array of ids\n *    The entity selector returns array of objects corresponding to the array of\n *    ids\n * 3. an object whose properties map to ids\n *    The entity selector returns an object whose properties map to the\n *    corresponding objects.\n *\n * Note: The selector parameter function can return either the id directly\n * or an object with a data property (because we use the format {\n *   data: id,\n *   isRequesting: true\n *   errors: [...]\n * }) where the value of the data property is the id, array of ids etc\n */\nexport default function createSelector(\n  arrayRules,\n  entitiesSelector,\n  entityType,\n  selector\n) {\n  const rules = processRules(arrayRules);\n  if (!rules[entityType]) throw `Key not found ${entityType}`;\n  const keys = [...new Set(getEntityTypes(rules, entityType))];\n\n  const selectors = [\n    // Only create a dependency on the normalized id (the data property of the\n    // object in the store for most cases).\n    state => {\n      const selection = selector(state);\n      const isObject = selection && typeof selection === 'object';\n\n      // This was a bad design decision. It's the only direct link with how\n      // objects are stored with Grim. Ideally the selector passed should\n      // point to the data property directly.\n      return isObject && 'data' in selection ? selection.data : selection;\n    },\n    // Turn keys into selectors\n    ...keys.map(key => state => entitiesSelector(state)[key])\n  ];\n\n  let lastSelected;\n  let lastDenormalized;\n\n  return state => {\n    const selected = selectors.map(selector => selector(state));\n    if (!arrayEquals(selected, lastSelected)) {\n      lastSelected = selected;\n      lastDenormalized = Immutable.from(\n        denormalize(rules, entityType, selected[0], entitiesSelector(state))\n      );\n    }\n    return lastDenormalized;\n  };\n}\n","import { static as Immutable } from 'seamless-immutable';\n\n// Updates entities in response to any action with response.entities.\n// Depends on the normalizerMiddelware\nexport default function normalizationReducer(state = {}, { meta }) {\n  if (meta && meta.method === 'delete' && meta.id) {\n    // Only a single item can be deleted at a time.\n    return Immutable.set(\n      state,\n      meta.entityType,\n      Immutable.without(state[meta.entityType], meta.id)\n    );\n  } else if (meta && meta.entities && typeof meta.entities === 'object') {\n    // Using seamless-immutable's deep merge resulted in an issue where an\n    // entity was supposed to have had a set of associated objects removed\n    // by setting the property to an empty object, but the deep merge retained\n    // those objects.\n    // Instead each entity type is merged separately using a shallow merge,\n    // which effectively replaces rather than merges individual entities.\n    let nextState = state;\n    Object.keys(meta.entities).forEach(\n      entityType =>\n        (nextState = Immutable.set(\n          nextState,\n          entityType,\n          Immutable.merge({}, [state[entityType], meta.entities[entityType]])\n        ))\n    );\n    return nextState;\n  }\n  return state;\n}\n","import resolveRule from './resolveRule';\nimport { idProp as idField, defaultId, propertiesProp } from './constants';\n\n/**\n * @param {Object} rules - object specifying how entities are\n *   normalized\n * @oaram {String} entityType - the type of the object\n * @param {Object | Array} obj - The object, or array of objects to normalize.\n *  If the object has no id, it's assumed that all the properties of the object\n *  are the objects (of the same type), to normalize.\n * @param {Object} state - an object which will be populated with properties\n *   mapping from entityType => ids => object\n *\n * @return {number | Array | Object } - an id, or array of ids, or an object\n *  whose properties map to ids.\n */\nexport default function normalize(rules, entityType, obj, state) {\n  if (!rules[entityType]) throw `Unrecognised entityType: ${entityType}`;\n\n  const { rule, entityType: type } = resolveRule(rules, entityType);\n\n  if (Array.isArray(obj)) {\n    return obj.map(item => normalize(rules, type, item, state));\n  }\n\n  if (!obj || typeof obj !== 'object') {\n    return obj;\n  }\n\n  const idProp = rule[idField] || defaultId;\n  const id = obj[idProp];\n\n  if (!id) {\n    return Object.entries(obj).reduce((o, [prop, item]) => {\n      o[prop] = normalize(rules, type, item, state);\n      return o;\n    }, {});\n  }\n\n  const entity = { ...obj };\n  state[type] = state[type] || {};\n  state[type][id] = entity;\n\n  if (rule[propertiesProp]) {\n    for (const [prop, type] of Object.entries(rule[propertiesProp])) {\n      entity[prop] = normalize(rules, type, obj[prop], state);\n    }\n  }\n\n  return id;\n}\n","import normalize from './normalize';\nimport processRules from './processRules';\nimport { isSuccessType } from '../util';\n\n/**\n * Create Redux middleware function which normalizes entities\n */\nexport default function getNormalizerMiddleware(arrayRules, callback) {\n  const rules = processRules(arrayRules);\n  return () => next => action => {\n    // Only normalize success actions\n    if (isSuccessType(action.type)) {\n      // entityType is added by autogenerated actions. Normalization only applies\n      // to autogenerated components.\n      const { payload, meta } = action;\n      const entityType = meta && meta.entityType;\n      if (entityType && payload && rules[entityType]) {\n        meta.entities = {};\n        action.payload = normalize(rules, entityType, payload, meta.entities);\n        callback && callback(entityType, payload);\n      }\n    }\n    return next(action);\n  };\n}\n"],"names":["addHooks","target","hooks","on","hook","fn","previousHook","first","rest","startExtension","successExtension","errorExtension","getStartType","entityType","getSuccessType","getErrorType","isSuccessType","type","endsWith","bodyMethods","parensReg","squareParensReg","defaultHooks","action","_namedParams","_restArgs","_options","defaultFunctions","method","url","body","toUpperCase","JSON","stringify","hasBodyParam","templateUrl","includes","getNamedParameters","params","Set","match","exec","str","periodIndex","indexOf","add","substr","size","makeUrlEvaluator","replace","Function","makeGetApiData","namedParams","urlEvaluator","args","reduce","o","param","ii","slice","length","makeActionCreator","options","debug","logActionCreation","mock","functions","getApiData","dispatch","restArgs","start","startAction","all","response","undefined","mockValue","console","info","apiFetch","success","successAction","payload","result","error","errorAction","unmock","log","join","validateActionParameters","hasBody","warn","forEach","define","defaultState","Immutable","from","defaultErrorKey","makeReducer","nextState","_prevState","_action","_state","state","startType","successType","errorType","errorKey","initialState","without","reducer","path","meta","concat","setIn","excludes","default","modifyInitialState","setAction","resetAction","defaultId","idProp","targetProp","propertiesProp","resolveRule","rules","rule","denormalize","id","Array","isArray","map","Object","entries","obj","prop","stateEntity","entity","configSchema","schemaRE","verifySchema","arr","schema","every","keys","schemaValue","propName","split","schemaType","isOptional","isObject","objValue","objType","values","val","cachedRules","previousRules","previousLength","processRules","arrayEquals","arr1","arr2","item","getEntityTypes","entityTypes","key","createSelector","arrayRules","entitiesSelector","selector","selectors","selection","data","lastSelected","lastDenormalized","selected","normalizationReducer","set","entities","babelHelpers.typeof","merge","normalize","idField","getNormalizerMiddleware","callback","next"],"mappings":"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"}